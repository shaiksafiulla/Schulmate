@using SchoolCoreWEB.Models
@model FeeReceipt
@using Localization.Services
@inject LanguageService _localization
@inject IConfiguration Configuration
@inject IHttpContextAccessor HttpContextAccessor
@{
	string strtoken = @HttpContextAccessor.HttpContext.Session.GetString("strtoken");
	string userParamkey = @HttpContextAccessor.HttpContext.Session.GetString("UserParam");

}
<div class="container-fluid p-0" style="max-width: 100%; page-break-before: always;">
    @Html.HiddenFor(m => m.PaymentId, new { @id = "hffeereceiptid" })

    <!-- Header Section (for the report) -->
    <div class="row mb-2" id="a4headdiv" style="width: 100%; padding: 0; overflow: hidden;">
        <img id="imgafourheader" class="img-fluid" alt="header image" style="padding: 0; display: block; max-width: 100%; max-height: 100px;" />
        <div id="divafourheaderspace"></div>
    </div>

    <!-- Main Report Section -->
    <div class="row" style="padding: 3%">
        <div class="col-12 text-center mb-4">
            <h4 class="mb-0 mt-2 font-weight-bold">@_localization.Getkey("FeeReceipt")</h4>
            <hr />
        </div>

        <!-- Report Details Table -->
        <table class="table table-sm mb-0" style="width: 100%">
            <tbody>
                <!-- Fee Receipt Info Section (Header & Details) -->
                <tr>
                    <td colspan="2">
                        <div class="content">
                            <div class="row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("ReceiptNo"):</strong></div>
                                        <div class="col-6"><strong><label id="lblReceiptNo"></label></strong></div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("Date"):</strong></div>
                                        <div class="col-6"><strong><label id="lblPayDate"></label></strong></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("Name"):</strong></div>
                                        <div class="col-6"><strong><label id="lblFullName"></label></strong></div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("SessionYear"):</strong></div>
                                        <div class="col-6"><strong><label id="lblSessionYear"></label></strong></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("AdmissionNo"):</strong></div>
                                        <div class="col-6"><strong><label id="lblAdmissionNo"></label></strong></div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("Class"):</strong></div>
                                        <div class="col-6"><strong><label id="lblClassSectionName"></label></strong></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("RollNo"):</strong></div>
                                        <div class="col-6"><strong><label id="lblRollNo"></label></strong></div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-6"><strong>@_localization.Getkey("Branch"):</strong></div>
                                        <div class="col-6"><strong><label id="lblBranchName"></label></strong></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>

                <!-- Transaction Details Table -->
                <tr>
                    <td colspan="2">
                        <div class="content">
                            <table class="table table-bordered table-sm table-hover mb-4">
                                <thead class="table-light">
                                    <tr>
                                        <th class="text-center">@_localization.Getkey("SNo")</th>
                                        <th class="text-center">@_localization.Getkey("Description")</th>
                                        <th class="text-center">@_localization.Getkey("DueAmount")</th>
                                        <th class="text-center">@_localization.Getkey("PaidAmount")</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="height: 200px; vertical-align: top;">
                                        <td class="text-center">1</td>
                                        <td class="text-center">Payment Towards School Fee</td>
                                        <td class="text-center"><label id="lblDueAmount"></label></td>
                                        <td class="text-center"><label id="lblPaidAmount"></label></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" class="text-left"><strong id="lblAmtWords"></strong></td>
                                        <td class="text-right"><strong>Total</strong></td>
                                        <td class="text-center"><label id="lblTotalAmount"></label></td>
                                    </tr>
                                </tbody>
                              
                            </table>
                        </div>
                    </td>
                </tr>

                <!-- Payment Information Section -->
                <tr>
                    <td colspan="2">
                        <div class="content">
                            <!-- Payment Information Header -->
                            <div class="col-12 text-center mb-4">
                                <h5 class="font-weight-bold">@_localization.Getkey("PaymentInformation")</h5>
                            </div>

                            <table class="table table-bordered table-sm mb-0">
                                <tbody>
                                    <tr>
                                        <td class="col-6"><strong>@_localization.Getkey("PayMode"):</strong></td>
                                        <td class="col-6"><strong><label id="lblPayMode"></label></strong></td>
                                    </tr>
                                    <tr>
                                        <td class="col-6"><strong>@_localization.Getkey("ReferenceNo"):</strong></td>
                                        <td class="col-6"><strong><label id="lblReferenceNo"></label></strong></td>
                                    </tr>
                                    <tr>
                                        <td class="col-6"><strong>@_localization.Getkey("Remarks"):</strong></td>
                                        <td class="col-6"><strong><label id="lblRemarks"></label></strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr style="height: 100px;"></tr>
            </tbody>
        </table>
        <!-- Footer -->
        <div class="text-center mt-4">
            <p><strong>This is a computer-generated report. Does not require a signature.</strong></p>
        </div>
    </div>

   
</div>





<link href="~/assets/css/reportprintstyle.css" rel="stylesheet" type="text/css" />
<script src="~/assets/vendor/jquery/jquery.min.js"></script>
<script src="~/assets/vendor/chart.js/chart.min.js"></script>
@* <script src="~/assets/js/action.js"></script> *@

<script>

		$(document).ready(function () {

			$('#a4headdiv').show();
			getStudentFeeReceipt();
		   });

	 function getStudentFeeReceipt() {
		  let paymentid = $("#hffeereceiptid").val();
          let url = '@Configuration["WebApi:ClientBaseUrl"]' + `/api/Student/StudentFeeReceipt/`+ paymentid +``;

		getOperation(url,`@strtoken`,`@Html.Raw(@userParamkey)`)
						.then(response => {
							console.log(response);
								fillReceipt(response);

						})
						.catch(error => {
							 toastr.error(`@_localization.Getkey("Error")`);
						});
	}

	function fillReceipt(data){
		 $("#lblReceiptNo").html(data.receiptNo);
		$("#lblFullName").html(data.fullName);
		$("#lblAdmissionNo").html(data.admissionNo);
		$("#lblRollNo").html(data.rollNo);

		// let jsDate = new Date(data.paymentDate);
		// let formattedDate = jsDate.toISOString().slice(0, 19); // Removes milliseconds and timezone

        $("#lblPayDate").html(data.paymentDate);
		$("#lblSessionYear").html(data.sessionYearName);
		$("#lblClassSectionName").html(data.classSectionName);
		$("#lblBranchName").html(data.branchName);		
      
		
            $("#lblDueAmount").html(parseFloat(data.dueAmount).toFixed(2));
            $("#lblPaidAmount").html(parseFloat(data.amount).toFixed(2));
            $("#lblTotalAmount").html(parseFloat(data.amount).toFixed(2));
				$("#lblPayMode").html(data.payModeName);
					$("#lblReferenceNo").html(data.referenceNo);
				$("#lblRemarks").html(data.remarks);

			var wds = convertNumberToWords(data.amount);
			$("#lblAmtWords").html("Amount in Words : " + wds);



         let imgpath ='@Configuration["WebApi:ClientBaseUrl"]';
		if(data.aFourHeaderType=="1"){
			$("#imgafourheader").show();
			$("#imgafourheader").attr("src", imgpath + "/" + data.aFourHeaderPhotoPath);
		}
		else{
			//Model.ReportSettings.AFourHeaderSpace + "px"
			$('#divafourheaderspace').css( "height", data.aFourHeaderSpace);
		}

	}

</script>










